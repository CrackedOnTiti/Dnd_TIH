<!DOCTYPE html>
<html>
<head>
    <title>Create Player</title>
</head>
<body>
    <h1>Create Player</h1>

    <label>Name:</label><br>
    <input type="text" id="playerName" oninput="checkForm()"><br><br>

    <label>Power:</label><br>
    <input type="text" id="power" oninput="checkForm()"><br><br>

    <label>Power Description:</label><br>
    <input type="text" id="powerDescription" oninput="checkForm()"><br><br>

    <label>Sex:</label><br>
    <select id="sex" onchange="checkForm()">
        <option value="">Select...</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
        <option value="Other">Other</option>
    </select><br><br>

    <label>Education:</label><br>
    <select id="education" onchange="checkForm()">
        <option value="">Select...</option>
        <option value="Power Oriented">Power Oriented</option>
        <option value="Hand to Hand">Hand to Hand</option>
        <option value="Weapon">Weapon</option>
    </select><br><br>

    <label>Physical Description:</label><br>
    <textarea id="physicalDescription" rows="4" cols="50" oninput="checkForm()"></textarea><br><br>

    <button id="createBtn" onclick="createPlayer()" style="display:none;">Create</button>
    <button onclick="window.location.href='/'">Back</button>

    <script>
        function checkForm() {
            const name = document.getElementById('playerName').value.trim();
            const power = document.getElementById('power').value.trim();
            const powerDesc = document.getElementById('powerDescription').value.trim();
            const sex = document.getElementById('sex').value;
            const education = document.getElementById('education').value;
            const physDesc = document.getElementById('physicalDescription').value.trim();

            const allFilled = name && power && powerDesc && sex && education && physDesc;
            document.getElementById('createBtn').style.display = allFilled ? 'inline' : 'none';
        }

        async function createPlayer() {
            const playerData = {
                player_name: document.getElementById('playerName').value.trim(),
                power: document.getElementById('power').value.trim(),
                power_description: document.getElementById('powerDescription').value.trim(),
                sex: document.getElementById('sex').value,
                physical_description: document.getElementById('physicalDescription').value.trim()
            };

            // Send to backend to save in database
            const response = await fetch('/api/player/create', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify(playerData)
            });

            const result = await response.json();
            if (result.success) {
                // Store player ID in localStorage
                localStorage.setItem('playerId', result.player_id);
                window.location.href = '/player';
            } else {
                alert('Error creating player: ' + result.error);
            }
        }
    </script>
</body>
</html>
